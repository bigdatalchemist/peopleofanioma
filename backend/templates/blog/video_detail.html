{% extends "base.html" %}
{% load static %}

{% block title %}{{ video.title }} — Video{% endblock %}

{% block content %}

<section class="bg-white dark:bg-gray-900 py-10">
  <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">

    <!-- Title + Meta -->
    <div class="mb-5">
      <div class="flex items-center gap-2 mb-2">
        {% if video.category %}
          <a href="{% url 'blog:video_list' %}?category={{ video.category.slug }}"
             class="inline-block text-xs font-semibold bg-orange-500 text-white rounded px-2 py-1">
            {{ video.category.name }}
          </a>
        {% endif %}
        <span class="text-xs text-gray-500 dark:text-gray-400">
          {% if video.published_at %}{{ video.published_at|date:"M j, Y" }}{% else %}{{ video.created_at|date:"M j, Y" }}{% endif %}
          • {{ video.views }} view{{ video.views|pluralize }}
        </span>
      </div>

      <h1 class="text-2xl md:text-3xl font-bold text-gray-900 dark:text-gray-100">{{ video.title }}</h1>
    </div>

    <!-- Player -->
    <div class="rounded-lg overflow-hidden shadow border border-gray-200 dark:border-gray-800 bg-black">
      {% if video.is_external %}
        <!-- External embed (expects an embeddable URL; for YouTube watch links, paste the embed URL in the admin) -->
        <div class="relative w-full" style="padding-top: 56.25%;">
          <iframe
            class="absolute inset-0 w-full h-full"
            src="{{ video.player_source }}"
            title="{{ video.title }}"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            allowfullscreen
          ></iframe>
        </div>
      {% elif video.video_file %}
        <video
          class="w-full h-auto"
          controls
          poster="{% if video.thumbnail %}{{ video.thumbnail.url }}{% endif %}"
        >
          <source src="{{ video.video_file }}">
          Your browser does not support the video tag.
        </video>
      {% else %}
        <div class="aspect-video flex items-center justify-center text-gray-400">
          <span>No video source available.</span>
        </div>
      {% endif %}
    </div>

    <!-- Description -->
    {% if video.description %}
      <div class="prose dark:prose-invert max-w-none mt-6">
        <p class="text-gray-800 dark:text-gray-200 whitespace-pre-line">{{ video.description }}</p>
      </div>
    {% endif %}

    <!-- Back link -->
    <div class="mt-8">
      <a href="{% url 'blog:video_list' %}"
         class="inline-flex items-center gap-2 text-orange-700 dark:text-orange-400 hover:underline">
        <!-- chevron-left -->
        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor">
          <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
        </svg>
        Back to videos
      </a>
    </div>
  </div>
</section>

{% endblock %}
